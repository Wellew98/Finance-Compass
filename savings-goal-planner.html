<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plan Your Success: Savings Goal Planner | Financial Compass</title>
    <meta name="description" content="Plan how to reach your savings goals in South Africa. Calculate required contributions based on your target amount and timeframe, with visual projections.">

    <link rel="icon" href="favicon.svg" type="image/svg+xml">
    <link rel="icon" href="favicon.ico" sizes="any">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js" integrity="sha5512-ElRFoEQdI5Ht6kZvyzXhYG9NqjtkmlkfYk0wr6wHxU9JEHakS7UJZNeml5ALk+8IKlU6jDgMabC3vkumRokgJA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.css" integrity="sha5512-5vJn8XQUg+xX9KdhOhHEqJH4LO8y7ILSFoGO0w0/idrbktwr/CmvSyF5vJn8XQUg+xX9KdhOhHEqJfSZYn7ar+V5CpQOJUWJBnddvjJJjP3Q==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
     <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@700&display=swap" rel="stylesheet">


    <style>
        /* --- Base Styles --- */
        :root {
            --primary: #0070D1; /* Blue */
            --primary-dark: #005bb1;
            --secondary: #00BC8C; /* Teal/Green */
            --secondary-dark: #009670;
            --accent: #FFC107; /* Yellow/Gold */
            --accent-dark: #e6ac00;
            --text: #333333;
            --text-light: #666666;
            --background: #FFFFFF;
            --background-alt: #F9FBFD; /* Very light blue/grey */
            --border: #E1E8ED;
            --shadow: rgba(0, 0, 0, 0.05);
            --radius: 10px;
            --error: #e74c3c;
            --success: #2ecc71;
            --warning: #ffc107; /* Added warning color */
            --info: #17a2b8;
             /* Chart Colors (Consistent with Retirement Calculator & Enhanced) */
            --chart-balance: #0070D1; /* Blue (Used for Total Value) */
            --chart-contributions: #00BC8C; /* Teal/Green (Used for Cumulative Contributions) */
            --chart-growth: #FFC107; /* Yellow for growth */
            --chart-balance-fill: rgba(0, 112, 209, 0.1); /* Light primary for area fill */
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth; /* Smooth scrolling for anchor links */
        }

        body {
            font-family: 'Poppins', sans-serif;
            color: var(--text);
            line-height: 1.6;
            background-color: var(--background);
            -webkit-font-smoothing: antialiased; /* Smoother fonts */
            -moz-osx-font-smoothing: grayscale;
        }
         body.no-scroll {
            overflow: hidden; /* Prevent scrolling when mobile menu is open */
        }

        a {
            text-decoration: none;
            color: var(--primary);
            transition: color 0.3s;
        }

        a:hover {
            color: var(--primary-dark);
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        img {
             max-width: 100%;
             height: auto;
             display: block; /* Prevents bottom space */
        }

        /* --- Buttons --- */
        .btn {
            display: inline-block;
            padding: 12px 28px;
            background-color: var(--primary);
            color: white;
            border-radius: var(--radius);
            font-weight: 500;
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent; /* Added for consistent height with outline */
            text-align: center;
            font-size: 1rem; /* Ensure consistent font size */
        }

        .btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 112, 209, 0.2);
        }

        .btn-secondary {
            background-color: var(--secondary);
        }

        .btn-secondary:hover {
            background-color: var(--secondary-dark);
            box-shadow: 0 4px 12px rgba(0, 188, 140, 0.2);
        }

        .btn-outline {
            background-color: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background-color: var(--primary);
            color: white;
        }
         .btn:disabled {
             opacity: 0.6;
             cursor: not-allowed;
             transform: none;
             box-shadow: none;
         }


        /* --- Header --- */
        header {
            background-color: var(--background);
            box-shadow: 0 2px 10px var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
            width: 100%;
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0; /* Adjust as needed */
            height: 73px; /* Explicit height for menu positioning */
        }

        .logo {
            display: flex;
            align-items: center;
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--text);
        }

        .logo i {
            color: var(--primary);
            margin-right: 10px;
            font-size: 1.8rem;
        }

        .logo span {
             color: var(--primary);
        }

        .nav-menu {
            display: flex;
            list-style: none;
        }

        .nav-item {
            margin-left: 28px;
        }

        .nav-link {
            color: var(--text);
            font-weight: 500;
            padding: 8px 4px;
            position: relative;
            font-size: 1rem;
        }

        .nav-link::after {
            content: '';
            position: absolute;
            bottom: -2px; /* Position slightly below text */
            left: 0;
            width: 0;
            height: 2px;
            background-color: var(--primary);
            transition: width 0.3s ease;
        }

        .nav-link:hover::after,
        .nav-link.active::after {
             width: 100%;
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 1.8rem;
            cursor: pointer;
            color: var(--text);
            padding: 5px; /* Easier to tap */
        }


        /* --- Calculator Section --- */
        .calculator-section {
            padding: 60px 0;
            background: linear-gradient(135deg, var(--background-alt), rgba(0, 188, 140, 0.05)); /* Subtle gradient background */
        }

        .section-title {
            font-size: 2.25rem;
            font-weight: 700; /* Slightly bolder */
            margin-bottom: 1rem;
            text-align: center;
            color: var(--primary-dark); /* Use a darker primary */
        }

        .section-subtitle {
            font-size: 1.1rem;
            color: var(--text-light);
            text-align: center;
            max-width: 700px;
            margin: 0 auto 3rem;
        }


        .calculator-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 40px;
        }

        .calculator-form {
            background-color: var(--background);
            border-radius: var(--radius);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08); /* More prominent shadow */
            padding: 30px;
            border: 1px solid var(--border);
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text);
             display: flex; /* Align label text and tooltip icon */
             align-items: center;
        }
         .form-label .fas { /* Style for info icon in label */
             margin-left: 6px;
             font-size: 0.9em;
             color: var(--primary);
         }


        .form-control {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            transition: border 0.3s ease, box-shadow 0.3s ease;
             background-color: var(--background-alt); /* Use alt background for inputs */
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(0, 112, 209, 0.15); /* More pronounced focus */
             background-color: var(--background); /* White background on focus */
        }

        .form-control.invalid {
             border-color: var(--error);
             box-shadow: 0 0 0 4px rgba(231, 76, 60, 0.15);
        }

        /* Input group styling */
        .input-group {
            display: flex;
            align-items: center;
        }

        .input-group-addon {
            padding: 12px 16px;
            background-color: var(--border); /* Use border colour for addon */
            border: 1px solid var(--border);
            border-right: none;
            border-radius: var(--radius) 0 0 var(--radius);
            color: var(--text); /* Darker text for addon */
            font-weight: 500;
        }
         .input-group-addon.suffix {
             border-radius: 0 var(--radius) var(--radius) 0;
             border-left: none;
             border-right: 1px solid var(--border);
         }

        .input-group .form-control {
            border-radius: 0 var(--radius) var(--radius) 0;
        }
         /* Adjust input padding when using suffix addon */
         .input-group .form-control[type="number"] {
             padding-right: 12px; /* Default padding */
         }
         .input-group .form-control + .input-group-addon.suffix {
            padding-left: 12px; /* Add padding back if suffix follows */
         }

        .form-message {
            display: none;
            margin-top: 6px;
            font-size: 0.9rem; /* Slightly larger font for messages */
            color: var(--error);
             font-weight: 500;
        }
         .form-message.active {
             display: block;
         }

        .action-buttons {
            display: flex;
            justify-content: space-between;
            gap: 16px;
            margin-top: 30px;
        }

        .action-buttons .btn {
            flex: 1;
        }


        /* Results section - Enhanced based on sars-tax-calculator */
        .calculator-results {
            background-color: var(--background);
            border-radius: var(--radius);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08); /* Consistent shadow */
            padding: 30px;
            border: 1px solid var(--border);
            position: relative;
            display: none; /* Hide results initially */
        }

        .results-header {
            margin-bottom: 24px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--primary); /* Prominent border */
        }

        .results-title {
            font-size: 1.6rem; /* Larger title */
            font-weight: 700; /* Bolder */
            color: var(--primary); /* Primary color */
            margin-bottom: 8px; /* Adjusted margin */
        }

        .results-subtitle {
            font-size: 1rem; /* Adjusted size */
            color: var(--text-light);
        }

        .results-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); /* Responsive grid for summary items */
            gap: 20px; /* Gap between summary items */
            margin-bottom: 30px; /* Space below summary */
        }

        .result-item {
            background-color: var(--background-alt);
            padding: 20px; /* Increased padding */
            border-radius: var(--radius);
            border: 1px solid var(--border);
            display: flex;
            flex-direction: column; /* Stack label and value */
            align-items: flex-start; /* Align text to the left */
             transition: all 0.3s ease; /* Add transition for hover */
        }
         /* Highlight key result items with colour */
         .result-item.highlight-primary {
             background-color: var(--highlight-blue); /* Light blue background */
             border-color: var(--primary); /* Primary border */
         }
          .result-item.highlight-secondary {
             background-color: var(--highlight-green); /* Light green background */
             border-color: var(--secondary); /* Secondary border */
         }


        .result-label {
            font-size: 0.95rem; /* Slightly smaller label */
            font-weight: 500;
            color: var(--text-light); /* Lighter text for label */
            margin-bottom: 8px; /* Space between label and value */
        }

        .result-value {
            font-size: 2rem; /* Larger value font */
            font-weight: 700; /* Bolder value */
            color: var(--text); /* Use text color for value initially */
             word-break: break-word; /* Prevent overflow */
        }
         .result-item.highlight-primary .result-value {
             color: var(--primary-dark); /* Dark primary for value in blue box */
         }
          .result-item.highlight-secondary .result-value {
             color: var(--secondary-dark); /* Dark secondary for value in green box */
         }


        .result-note {
            font-size: 0.8rem;
            color: var(--text-light);
            margin-top: auto; /* Push note to the bottom */
             padding-top: 10px;
             border-top: 1px dashed var(--border); /* Dashed line separator */
             width: 100%; /* Ensure note takes full width */
        }

        .chart-container {
            position: relative;
            margin-top: 24px; /* Adjusted margin */
            height: 350px; /* Adjusted height for line chart */
            width: 100%;
             display: flex;
             justify-content: center;
             align-items: center;
        }
         .chart-container canvas {
             max-width: 100%;
             max-height: 100%;
         }

         .chart-title {
            text-align: center;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 1.5rem; /* More space below title */
            font-size: 1.3rem; /* Slightly larger title for chart */
        }


        /* --- FAQ Section --- */
        .faq-section {
            padding: 60px 0;
            background-color: var(--background);
        }

        .accordion {
            margin-top: 40px;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            overflow: hidden;
        }

        .accordion-item {
            border-bottom: 1px solid var(--border);
        }

        .accordion-item:last-child {
            border-bottom: none;
        }

        .accordion-header {
            background-color: var(--background);
            padding: 20px 24px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.3s ease;
        }

        .accordion-header:hover {
            background-color: var(--background-alt);
        }

        .accordion-title {
            font-size: 1.1rem;
            font-weight: 500;
            color: var(--text);
        }

        .accordion-icon {
            transition: transform 0.3s ease;
        }

        .accordion-content {
            padding: 0;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease-in-out, padding 0.4s ease-in-out; /* Smooth transition */
        }

        .accordion-content-inner {
            padding: 20px 24px 24px; /* Applied padding here */
            color: var(--text-light);
            border-top: 1px solid var(--border); /* Add border on top when open */
        }
         .accordion-item.active .accordion-content-inner {
             padding-top: 20px; /* Ensure consistent padding top when active */
         }


        .accordion-item.active .accordion-header {
            background-color: var(--background-alt);
        }

        .accordion-item.active .accordion-icon {
            transform: rotate(180deg);
        }

        .accordion-item.active .accordion-content {
            max-height: 1000px; /* Sufficiently large value */
             /* Padding is now handled by accordion-content-inner */
        }

        /* Calculator Tips - Styled like the info-box from tax calculator */
        .tip-box {
            margin-top: 30px;
            padding: 20px;
            background-color: rgba(0, 112, 209, 0.05); /* Primary tint background */
            border-left: 4px solid var(--primary); /* Primary border */
            border-radius: 0 var(--radius) var(--radius) 0; /* Rounded on the right */
             box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05); /* Subtle shadow */
        }

        .tip-title {
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            color: var(--primary); /* Primary color for title */
            font-size: 1.1rem; /* Slightly larger title */
        }

        .tip-title i {
            margin-right: 10px;
             color: var(--accent); /* Use accent color for the lightbulb icon */
             font-size: 1.2em; /* Make icon a bit larger */
        }

        .tip-content {
            font-size: 0.95rem; /* Adjusted font size */
            color: var(--text-light);
        }

        .tip-content ul {
            margin-top: 10px;
            padding-left: 25px;
        }

        .tip-content li {
            margin-bottom: 8px; /* More space between list items */
        }


        /* --- Footer (Copied from updated index.html) --- */
        footer {
            background-color: #1e293b;
            color: rgba(255, 255, 255, 0.8);
            padding: 64px 0 32px;
            font-size: 0.95rem;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 48px;
            margin-bottom: 48px;
        }

        .footer-column.about .footer-logo {
             color: white;
             font-size: 1.6rem;
             margin-bottom: 16px;
             display: inline-flex; /* Align icon and text */
             align-items: center;
        }
        .footer-column.about .footer-logo i {
             color: var(--primary);
             margin-right: 10px;
        }


        .footer-description {
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 24px;
            line-height: 1.7;
        }

        .footer-social {
            display: flex;
            gap: 12px;
        }

        .footer-social-link {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .footer-social-link:hover {
            background-color: var(--primary);
            transform: translateY(-3px);
        }

        .footer-heading {
            font-size: 1.15rem;
            font-weight: 600;
            margin-bottom: 24px;
            color: white;
        }

        .footer-links {
            list-style: none;
            padding: 0; /* Remove default padding */
        }

        .footer-link {
            margin-bottom: 12px;
        }

        .footer-link a {
            color: rgba(255, 255, 255, 0.7);
            transition: all 0.3s ease;
        }

        /* Modified footer link hover based on the index inspiration */
        .footer-link a:hover {
            color: var(--secondary); /* Use secondary color for hover */
            padding-left: 8px; /* Add subtle slide effect */
        }


        .footer-bottom {
            border-top: 1px solid rgba(255, 255, 255, 0.15);
            padding-top: 32px;
            margin-top: 16px; /* Add margin above bottom line */
            text-align: center;
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.875rem;
        }


        /* --- Responsive Styles --- */
        @media (max-width: 992px) {
            .nav-menu {
                position: fixed;
                top: 73px; /* Match header height */
                left: -100%;
                flex-direction: column;
                background-color: var(--background);
                width: 100%;
                height: calc(100vh - 73px);
                transition: left 0.3s ease-in-out;
                box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
                padding: 20px 0; /* Add padding top/bottom */
                overflow-y: auto;
                z-index: 999; /* Ensure it's below header but above content */
             }

             .nav-menu.active {
                left: 0;
             }

             .nav-item {
                margin: 0;
                width: 100%;
             }
             .nav-link {
                 display: block;
                 padding: 16px 30px; /* Increase padding */
                 text-align: left; /* Align text left */
                 border-bottom: 1px solid var(--border);
                 font-size: 1.1rem; /* Slightly larger font */
             }
             .nav-link:hover {
                 background-color: var(--background-alt);
             }
              .nav-link::after {
                 display: none; /* Hide underline on mobile */
             }
             /* Style last nav item without border */
             .nav-item:last-child .nav-link {
                 border-bottom: none;
             }

             .mobile-menu-btn {
                 display: block;
             }

             .calculator-container {
                grid-template-columns: 1fr; /* Stack form and results */
             }
             .calculator-results {
                 margin-top: 30px; /* Add space when stacked */
             }
        }

        @media (max-width: 768px) {
            .section {
                padding: 64px 0;
            }
            .section-title {
                font-size: 2rem;
            }
            .section-subtitle {
                 font-size: 1.1rem;
            }
            .results-summary {
                grid-template-columns: 1fr; /* Stack summary items */
            }
            .result-value {
                 font-size: 1.8rem; /* Adjust size */
            }
             .chart-title {
                 font-size: 1.1rem; /* Adjust chart title size */
             }

            .footer-content {
                grid-template-columns: 1fr;
                text-align: center;
            }
            .footer-column {
                 display: flex;
                 flex-direction: column;
                 align-items: center;
            }
             .footer-column.about .footer-logo {
                 justify-content: center; /* Center logo items */
             }
            .footer-social {
                 justify-content: center;
            }
            .footer-links {
                 text-align: center;
            }
        }

         @media (max-width: 576px) {
             .section-title {
                 font-size: 1.75rem;
             }
             .section-subtitle {
                 font-size: 1rem;
             }
             .result-value {
                 font-size: 1.6rem; /* Further adjust size */
             }
             .header-container {
                 padding: 12px 0;
                 height: 65px;
             }
             .nav-menu {
                 top: 65px;
                 height: calc(100vh - 65px);
             }
             .logo {
                 font-size: 1.4rem;
             }
             .logo i {
                 font-size: 1.6rem;
             }
             .action-buttons {
                 flex-direction: column;
                 gap: 12px;
             }
             .btn {
                 width: 90%; /* Make buttons wider */
                 max-width: 320px;
                 padding: 14px 20px; /* Adjust padding */
             }
              .form-group {
                  margin-bottom: 20px; /* Reduce spacing */
              }
               .form-control {
                   padding: 10px 14px; /* Adjust input padding */
                   font-size: 0.95rem;
               }
               .input-group-addon {
                   padding: 10px 14px; /* Adjust addon padding */
               }
                .accordion-header {
                    padding: 16px 20px; /* Adjust accordion header padding */
                }
                .accordion-title {
                    font-size: 1rem; /* Adjust accordion title size */
                }
                .accordion-content-inner {
                     padding: 16px 20px 20px; /* Adjust accordion content padding */
                }
                .tip-box {
                     padding: 16px; /* Adjust tip box padding */
                }
                .tip-title {
                     font-size: 1rem; /* Adjust tip title size */
                }
                .tip-title i {
                     font-size: 1.1em; /* Adjust tip icon size */
                }
         }
    </style>
</head>
<body>
    <header>
        <div class="container header-container">
            <a href="/" class="logo"> <i class="fas fa-compass"></i> Financial<span>Compass</span>
            </a>

            <nav>
                <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Open Menu" aria-expanded="false" aria-controls="navMenu">
                    <i class="fas fa-bars"></i>
                </button>
                <ul class="nav-menu" id="navMenu">
                    <li class="nav-item"><a href="/" class="nav-link">Home</a></li>
                    <li class="nav-item"><a href="/#tools" class="nav-link active">Financial Tools</a></li>
                    <li class="nav-item"><a href="/#about" class="nav-link">Why Us</a></li>
                    <li class="nav-item"><a href="/#updates" class="nav-link">Updates</a></li>
                    </ul>
            </nav>
        </div>
    </header>

    <main>
        <section class="calculator-section">
            <div class="container">
                <h1 class="section-title">Plan Your Success: Savings Goal Planner</h1>
                <p class="section-subtitle">Chart your course to financial freedom! This tool helps you figure out how much you need to save regularly to hit your targets.</p>

                <div class="calculator-container">
                    <div class="calculator-form">
                        <h2 class="results-title">Map Your Savings Journey</h2> <form id="savingsGoalForm">
                            <div class="form-group">
                                <label for="goalAmount" class="form-label">Your Savings Goal Amount<i class="fas fa-info-circle"></i></label>
                                <div class="input-group">
                                    <span class="input-group-addon">R</span>
                                    <input type="number" id="goalAmount" class="form-control" value="100000" min="1000" step="100" required>
                                </div>
                                <span class="form-message" id="goalAmountError">Please enter a valid positive savings goal amount.</span>
                            </div>

                            <div class="form-group">
                                <label for="currentSavings" class="form-label">Current Savings<i class="fas fa-info-circle"></i></label>
                                <div class="input-group">
                                    <span class="input-group-addon">R</span>
                                    <input type="number" id="currentSavings" class="form-control" value="10000" min="0" step="100" required>
                                </div>
                                <span class="form-message" id="currentSavingsError">Please enter a valid current savings amount (cannot exceed your goal).</span>
                            </div>

                             <div class="form-group">
                                 <label for="timeframe" class="form-label">Timeframe to Reach Goal<i class="fas fa-info-circle"></i></label>
                                 <div class="input-group">
                                     <input type="number" id="timeframe" class="form-control" value="5" min="1" required>
                                     <span class="input-group-addon suffix" id="timeframeUnit">Years</span>
                                 </div>
                                  <span class="form-message" id="timeframeError">Please enter a valid positive timeframe.</span>
                             </div>

                             <div class="form-group">
                                 <label for="timeframeType" class="form-label">Timeframe Unit</label>
                                 <select id="timeframeType" class="form-control">
                                     <option value="years">Years</option>
                                     <option value="months">Months</option>
                                 </select>
                             </div>


                             <div class="form-group">
                                 <label for="annualGrowthRate" class="form-label">Expected Annual Investment Growth<i class="fas fa-info-circle"></i></label>
                                  <div class="input-group">
                                     <input type="number" id="annualGrowthRate" class="form-control" value="6" min="0" max="20" step="0.1" required>
                                      <span class="input-group-addon suffix">% p.a.</span>
                                  </div>
                                   <span class="form-message" id="annualGrowthRateError">Please enter a valid annual growth rate (e.g., 6 for 6%).</span>
                             </div>


                            <div class="action-buttons">
                                <button type="button" id="savingsCalculateBtn" class="btn btn-primary"><i class="fas fa-chart-line"></i> Plan Savings</button>
                                <button type="reset" id="savingsResetBtn" class="btn btn-outline"><i class="fas fa-redo"></i> Reset</button>
                            </div>
                        </form>
                    </div>

                    <div class="calculator-results" id="savingsResultsSection">
                        <div class="results-header">
                            <h3 class="results-title">Your Savings Blueprint Revealed!</h3>
                            <p class="results-subtitle">Here’s what it takes to turn your savings goal into reality.</p>
                        </div>

                        <div class="results-summary">
                            <div class="result-item highlight-primary"> <span class="result-label">Amount Needed to Save:</span>
                                <span class="result-value" id="amountToSave">R0.00</span>
                                <div class="result-note">Excluding current savings</div>
                            </div>
                            <div class="result-item highlight-secondary"> <span class="result-label" id="requiredContributionLabel">Required Monthly Contribution:</span>
                               <span class="result-value" id="requiredContribution">R0.00</span>
                               <div class="result-note">Based on your timeframe and growth</div>
                           </div>
                            <div class="result-item">
                                <span class="result-label">Projected Final Savings:</span>
                                <span class="result-value" id="projectedFinalSavings">R0.00</span>
                                <div class="result-note">Includes your contributions + estimated growth</div>
                            </div>
                            <div class="result-item">
                                <span class="result-label">Total Contributed by You:</span>
                                <span class="result-value" id="totalContributed">R0.00</span>
                                <div class="result-note">Sum of your regular contributions + initial savings</div>
                            </div>
                             <div class="result-item">
                                <span class="result-label">Total Estimated Growth Earned:</span>
                                <span class="result-value" id="totalGrowthEarned">R0.00</span>
                                <div class="result-note">The power of compounding in action!</div>
                            </div>
                        </div>

                        <div class="visualization-container">
                             <h4 class="chart-title">How Your Savings Could Grow Over Time</h4>
                            <div class="chart-container">
                                <canvas id="savingsGrowthChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                 <div class="tip-box">
                        <h4 class="tip-title"><i class="fas fa-lightbulb"></i> Smart Savings Tips in SA</h4>
                        <div class="tip-content">
                            <p>Use these strategies to make reaching your goal easier:</p>
                            <ul>
                                <li><strong>Set SMART Goals:</strong> Make your goals Specific, Measurable, Achievable, Relevant, and Time-bound.</li>
                                <li><strong>Automate Savings:</strong> Set up automatic transfers from your current account to your savings account each payday – "out of sight, out of mind" for easier saving!</li>
                                <li><strong>Reduce Expenses:</strong> Find areas in your budget to cut back. Even small savings add up significantly over time.</li>
                                <li><strong>Increase Income:</strong> Explore ways to earn extra income, like a side hustle or selling unused items.</li>
                                 <li><strong>Track & Adjust:</strong> Regularly check your progress. If you're ahead of schedule, fantastic! If you're behind, adjust your contributions or timeframe.</li>
                                  <li><strong>Choose Wisely:</strong> Research savings accounts or investments (like Tax-Free Savings Accounts) that offer the best returns for your timeframe and comfort level with risk.</li>
                            </ul>
                        </div>
                    </div>

            </div>
        </section>

         <section class="faq-section">
            <div class="container">
                <h2 class="section-title">Savings FAQs</h2> <p class="section-subtitle">Get answers to common questions about planning and achieving your savings goals.</p>

                <div class="accordion" id="savingsFAQ">
                    <div class="accordion-item">
                        <div class="accordion-header">
                            <h3 class="accordion-title">How much should I aim to save each month?</h3>
                            <i class="accordion-icon fas fa-chevron-down"></i>
                        </div>
                        <div class="accordion-content">
                            <div class="accordion-content-inner">
                                <p>There's no one-size-fits-all answer. It depends on your income, current expenses, debts, and the size and urgency of your savings goal. A common guideline is the 50/30/20 rule (50% needs, 30% wants, 20% savings/debt repayment), but this calculator gives you a concrete monthly target for your specific goal.</p>
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <div class="accordion-header">
                            <h3 class="accordion-title">Where is the best place to keep my savings in South Africa?</h3>
                            <i class="accordion-icon fas fa-chevron-down"></i>
                        </div>
                        <div class="accordion-content">
                            <div class="accordion-content-inner">
                                <p>For short-term goals (money you might need in less than 1-3 years), consider high-yield savings accounts or money market accounts offered by banks. They offer easy access and low risk. For longer-term goals, explore Tax-Free Savings Accounts (TFSAs) or investments like unit trusts, which can offer higher growth potential over time (though they carry more risk).</p>
                            </div>
                        </div>
                    </div>
                     <div class="accordion-item">
                        <div class="accordion-header">
                            <h3 class="accordion-title">How does the 'growth rate' affect my savings plan?</h3>
                            <i class="accordion-icon fas fa-chevron-down"></i>
                        </div>
                        <div class="accordion-content">
                            <div class="accordion-content-inner">
                                <p>The annual growth rate (your expected return on savings/investments) is crucial due to compounding. The higher the growth rate, the less you might need to contribute yourself to reach your goal, as your existing savings and earned growth will also be earning returns. Be realistic with your growth rate – higher potential returns often come with higher risk.</p>
                            </div>
                        </div>
                    </div>
                     <div class="accordion-item">
                        <div class="accordion-header">
                            <h3 class="accordion-title">What if I can't meet the required monthly contribution?</h3>
                            <i class="accordion-icon fas fa-chevron-down"></i>
                        </div>
                        <div class="accordion-content">
                            <div class="accordion-content-inner">
                                <p>Don't be discouraged! If the calculated contribution is too high, you have a few options: aim for a smaller savings goal, extend your timeframe, or explore ways to increase your income or decrease your expenses to free up more cash for saving. Consistency is key, even if the amount is smaller than initially planned.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column about">
                    <a href="/" class="footer-logo">
                        <i class="fas fa-compass"></i> Financial<span>Compass</span>
                    </a>
                    <p class="footer-description">Your free guide to navigating South African personal finance. Empowering you with clear, accurate tools and insights.</p>
                    <div class="footer-social">
                        <a href="https://www.facebook.com/profile.php?id=61575624285316" class="footer-social-link" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://x.com/FinCompassSA" class="footer-social-link" aria-label="X (formerly Twitter)"><i class="fab fa-twitter"></i></a>
                        <a href="https://www.linkedin.com/company/107288558" class="footer-social-link" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                    </div>
                </div>

                <div class="footer-column links">
                    <h3 class="footer-heading">Quick Links</h3>
                    <ul class="footer-links">
                        <li class="footer-link"><a href="/">Home</a></li>
                        <li class="footer-link"><a href="/#tools">Financial Tools</a></li>
                        <li class="footer-link"><a href="/#about">Why Us</a></li>
                        <li class="footer-link"><a href="/#updates">Updates</a></li>
                         <li class="footer-link"><a href="terms-privacy.html">Terms & Privacy</a></li>
                        </ul>
                </div>

                 <div class="footer-column calculators">
                    <h3 class="footer-heading">Calculators</h3>
                    <ul class="footer-links">
                        <li class="footer-link"><a href="sars-tax-calculator.html">SARS Tax Calculator</a></li>
                        <li class="footer-link"><a href="budget-planner.html">Budget Planner</a></li>
                        <li class="footer-link"><a href="loan-calculators.html">Loan Calculators</a></li>
                        <li class="footer-link"><a href="vat-calculator.html">VAT Calculator</a></li>
                        <li class="footer-link"><a href="retirement-calculator.html">Retirement Calculator</a></li>
                        <li class="footer-link"><a href="savings-goal-planner.html">Savings Goal Planner</a></li>
                    </ul>
                </div>

                 <div class="footer-column contact">
                    <h3 class="footer-heading">Disclaimer</h3>
                     <p class="footer-description" style="font-size: 0.85rem; color: rgba(255,255,255,0.5);">
                        Financial Compass provides tools for estimation purposes only. Information should not be considered financial advice. Always consult a qualified professional for financial decisions.
                    </p>
                    </div>

            </div>
            <div class="footer-bottom">
                &copy; <span id="currentYear"></span> Financial Compass. Built for South Africans. All Rights Reserved.
            </div>
        </div>
    </footer>


    <script>
        // --- Mobile Menu Toggle ---
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const navMenu = document.getElementById('navMenu');
        const body = document.body;

        if (mobileMenuBtn && navMenu) {
            mobileMenuBtn.addEventListener('click', () => {
                const isExpanded = navMenu.classList.toggle('active');
                mobileMenuBtn.setAttribute('aria-expanded', isExpanded);
                const icon = mobileMenuBtn.querySelector('i');
                if (icon) {
                    icon.className = isExpanded ? 'fas fa-times' : 'fas fa-bars';
                }
                body.classList.toggle('no-scroll', isExpanded);
            });

            navMenu.querySelectorAll('a[href^="#"]').forEach(link => {
                link.addEventListener('click', (e) => {
                    if (navMenu.classList.contains('active')) {
                        navMenu.classList.remove('active');
                        mobileMenuBtn.setAttribute('aria-expanded', 'false');
                        const icon = mobileMenuBtn.querySelector('i');
                        if (icon) {
                             icon.className = 'fas fa-bars';
                         }
                         body.classList.remove('no-scroll');
                    }
                });
            });
             // Close menu when clicking outside (basic implementation)
             document.addEventListener('click', (e) => {
                 // Check if the menu is active and the click is outside the menu and the button
                 if (navMenu.classList.contains('active') && !navMenu.contains(e.target) && !mobileMenuBtn.contains(e.target)) {
                     navMenu.classList.remove('active');
                     mobileMenuBtn.setAttribute('aria-expanded', 'false');
                     const icon = mobileMenuBtn.querySelector('i');
                     if (icon) {
                         icon.className = 'fas fa-bars';
                     }
                     body.classList.remove('no-scroll');
                 }
             });
             // Close menu if a link to a different page is clicked
             navMenu.querySelectorAll('a:not([href^="#"])').forEach(link => {
                link.addEventListener('click', () => {
                     if (navMenu.classList.contains('active')) {
                        navMenu.classList.remove('active');
                        mobileMenuBtn.setAttribute('aria-expanded', 'false');
                        const icon = mobileMenuBtn.querySelector('i');
                        if (icon) {
                             icon.className = 'fas fa-bars';
                        }
                         body.classList.remove('no-scroll');
                     }
                });
            });
        }

        // --- Footer Year ---
        const currentYearSpan = document.getElementById('currentYear');
        if (currentYearSpan) {
            currentYearSpan.textContent = new Date().getFullYear();
        }

        // --- Accordion Functionality ---
        const accordionItems = document.querySelectorAll('.accordion-item');
        accordionItems.forEach(item => {
            const header = item.querySelector('.accordion-header');
            header.addEventListener('click', () => {
                // Close all other items
                accordionItems.forEach(otherItem => {
                    if (otherItem !== item) {
                        otherItem.classList.remove('active');
                         const otherContent = otherItem.querySelector('.accordion-content');
                         if(otherContent) otherContent.style.maxHeight = null; // Reset max-height
                    }
                });

                // Toggle the clicked item
                item.classList.toggle('active');
                const content = item.querySelector('.accordion-content');
                 if (item.classList.contains('active')) {
                     content.style.maxHeight = content.scrollHeight + "px"; // Set max-height to content height
                 } else {
                     content.style.maxHeight = null; // Reset max-height
                 }
            });
        });


        // --- Helper Functions ---
        function formatCurrency(amount) {
            const numericAmount = parseFloat(amount);
            if (isNaN(numericAmount)) {
                return 'R0.00';
            }
             // Use toLocaleString with minimum and maximum fraction digits for consistency
            return 'R' + numericAmount.toLocaleString('en-ZA', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        }


        // --- Get CSS Chart Colors ---
        // Fetch the computed styles from the root element once
        const style = getComputedStyle(document.documentElement);
        const chartBalanceColor = style.getPropertyValue('--chart-balance').trim();
        const chartContributionsColor = style.getPropertyValue('--chart-contributions').trim();
        const chartGrowthColor = style.getPropertyValue('--chart-growth').trim();
        const chartBalanceFillColor = style.getPropertyValue('--chart-balance-fill').trim();


        // --- Savings Goal Planner Logic ---
        const savingsGoalForm = document.getElementById('savingsGoalForm');
        const goalAmountInput = document.getElementById('goalAmount');
        const currentSavingsInput = document.getElementById('currentSavings');
        const timeframeInput = document.getElementById('timeframe');
        const timeframeTypeSelect = document.getElementById('timeframeType');
        const timeframeUnitSpan = document.getElementById('timeframeUnit');
        const annualGrowthRateInput = document.getElementById('annualGrowthRate');
        const savingsCalculateBtn = document.getElementById('savingsCalculateBtn');
        const savingsResetBtn = document.getElementById('savingsResetBtn');
        const savingsResultsSection = document.getElementById('savingsResultsSection');

        const amountToSaveEl = document.getElementById('amountToSave');
        const requiredContributionLabelEl = document.getElementById('requiredContributionLabel');
        const requiredContributionEl = document.getElementById('requiredContribution');
        const projectedFinalSavingsEl = document.getElementById('projectedFinalSavings');
        const totalContributedEl = document.getElementById('totalContributed');
        const totalGrowthEarnedEl = document.getElementById('totalGrowthEarned');
        const savingsGrowthCanvas = document.getElementById('savingsGrowthChart');

        // Error message elements
        const goalAmountError = document.getElementById('goalAmountError');
        const currentSavingsError = document.getElementById('currentSavingsError');
        const timeframeError = document.getElementById('timeframeError');
        const annualGrowthRateError = document.getElementById('annualGrowthRateError');

        let savingsGrowthChart = null; // To hold the chart instance


        // Update the timeframe unit text and label based on the select value
        if (timeframeTypeSelect && timeframeUnitSpan && requiredContributionLabelEl) {
            timeframeTypeSelect.addEventListener('change', function() {
                const selectedValue = timeframeTypeSelect.value;
                timeframeUnitSpan.textContent = selectedValue === 'years' ? 'Years' : 'Months';
                requiredContributionLabelEl.textContent = selectedValue === 'years' ? 'Required Annual Contribution:' : 'Required Monthly Contribution:';

                 // Adjust min/max for timeframe input based on type (optional but good practice)
                 if (timeframeInput) {
                     if (selectedValue === 'years') {
                         timeframeInput.min = 1;
                         timeframeInput.max = 60; // Example max years (60 years)
                         if (parseInt(timeframeInput.value) > 60) timeframeInput.value = 60;
                         if (parseInt(timeframeInput.value) < 1) timeframeInput.value = 1;
                         timeframeInput.step = 1;
                     } else { // months
                         timeframeInput.min = 1;
                         timeframeInput.max = 720; // Example max months (60 years * 12)
                          if (parseInt(timeframeInput.value) > 720) timeframeInput.value = 720;
                          if (parseInt(timeframeInput.value) < 1) timeframeInput.value = 1;
                          timeframeInput.step = 1;
                     }
                 }
            });
        }


        function calculateSavingsGoal() {
             // Use a timeout to allow the button click animation to start
             setTimeout(async () => {
                savingsCalculateBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Planning...';
                savingsCalculateBtn.disabled = true;

                // Clear previous errors
                document.querySelectorAll('.form-message').forEach(msg => {
                    msg.textContent = '';
                    msg.classList.remove('active');
                });
                 document.querySelectorAll('.form-control').forEach(input => {
                     input.classList.remove('invalid');
                 });


                // Get input values
                const goalAmount = goalAmountInput ? parseFloat(goalAmountInput.value) : NaN;
                let currentSavings = currentSavingsInput ? parseFloat(currentSavingsInput.value) || 0 : NaN;
                const timeframe = timeframeInput ? parseInt(timeframeInput.value) : NaN;
                const timeframeType = timeframeTypeSelect ? timeframeTypeSelect.value : 'years';
                const annualGrowthRate = annualGrowthRateInput ? parseFloat(annualGrowthRateInput.value) / 100 : NaN;

                // Input Validation
                let isValid = true;
                if (isNaN(goalAmount) || goalAmount <= 0) {
                    if(goalAmountError) {
                        goalAmountError.textContent = 'Please enter a valid positive savings goal amount.';
                        goalAmountError.classList.add('active');
                    }
                    if(goalAmountInput) goalAmountInput.classList.add('invalid');
                    isValid = false;
                }
                 if (isNaN(currentSavings) || currentSavings < 0) {
                      if(currentSavingsError) {
                          currentSavingsError.textContent = 'Please enter a valid current savings amount (cannot be negative).';
                          currentSavingsError.classList.add('active');
                      }
                      if(currentSavingsInput) currentSavingsInput.classList.add('invalid');
                      isValid = false;
                 }
                if (isNaN(timeframe) || timeframe <= 0) {
                     if(timeframeError) {
                         timeframeError.textContent = 'Please enter a valid positive timeframe.';
                         timeframeError.classList.add('active');
                     }
                     if(timeframeInput) timeframeInput.classList.add('invalid');
                     isValid = false;
                 }
                 if (isNaN(annualGrowthRate) || annualGrowthRate < 0 || annualGrowthRate > 1) { // Rates as decimals
                      if(annualGrowthRateError) {
                          annualGrowthRateError.textContent = 'Please enter a valid annual growth rate (0-100%).';
                          annualGrowthRateError.classList.add('active');
                      }
                      if(annualGrowthRateInput) annualGrowthRateInput.classList.add('invalid');
                      isValid = false;
                 }

                 if (isValid && currentSavings >= goalAmount) {
                      if(currentSavingsError) {
                          currentSavingsError.textContent = 'Your current savings already meet or exceed your goal! No further contributions needed.';
                          currentSavingsError.classList.add('active');
                      }
                       if(currentSavingsInput) currentSavingsInput.classList.add('invalid');
                       isValid = false;
                 }


                if (!isValid) {
                    clearSavingsGoalResults(); // Clear results and hide section on error
                     savingsCalculateBtn.innerHTML = '<i class="fas fa-chart-line"></i> Plan Savings';
                     savingsCalculateBtn.disabled = false;
                    return;
                }

                const numberOfMonths = timeframeType === 'years' ? timeframe * 12 : timeframe; // Total months for calculation
                const monthlyGrowthRate = annualGrowthRate / 12;

                const amountNeededFromNow = goalAmount - currentSavings;


                // --- Calculate Required Contribution ---
                let requiredMonthlyContribution = 0;

                 // Handle case where no growth rate is expected
                 if (monthlyGrowthRate <= 0) {
                     requiredMonthlyContribution = amountNeededFromNow / numberOfMonths;
                 } else {
                      // Using Future Value of an Ordinary Annuity formula, rearranged to solve for Payment (PMT)
                      // FV = PV * (1 + r)^n + PMT * [((1 + r)^n - 1) / r]
                      // PMT = [FV - PV * (1 + r)^n] / [((1 + r)^n - 1) / r]
                      const fvOfCurrentSavings = currentSavings * Math.pow(1 + monthlyGrowthRate, numberOfMonths);
                      const futureValueFactor = (Math.pow(1 + monthlyGrowthRate, numberOfMonths) - 1) / monthlyGrowthRate;

                      if (futureValueFactor > 0) { // Avoid division by zero if numberOfMonths is 0 (though validation should prevent)
                          requiredMonthlyContribution = (goalAmount - fvOfCurrentSavings) / futureValueFactor;
                      } else {
                          // Should only happen if numberOfMonths is 0, handled by validation
                           requiredMonthlyContribution = amountNeededFromNow; // Requires saving full amount immediately
                      }
                 }

                // Ensure contribution is not negative if calculations result in a slight negative due to float precision near goal
                requiredMonthlyContribution = Math.max(0, requiredMonthlyContribution);


                // --- Simulate Growth for Chart Data ---
                let simulatedBalance = currentSavings;
                let simulatedTotalContributed = 0;

                 const periodLabels = ['Start']; // Start at period 0 (initial savings)
                 const balanceData = [currentSavings]; // Initial balance
                 const contributionsData = [currentSavings]; // Initial contributions (starting point for cumulative)
                 const growthData = [0]; // Initial growth is 0


                for (let month = 1; month <= numberOfMonths; month++) {
                     simulatedBalance += requiredMonthlyContribution;
                     simulatedTotalContributed += requiredMonthlyContribution;
                     simulatedBalance *= (1 + monthlyGrowthRate);

                     // Store data points - adjust frequency for performance on long timeframes
                     const periodInterval = timeframeType === 'years' ? 12 : 1; // Chart every year or every month
                     if (month % periodInterval === 0 || month === numberOfMonths) { // Always include the final month
                          const label = timeframeType === 'years' ? `Year ${month / 12}` : `Month ${month}`;
                          periodLabels.push(label);
                          balanceData.push(simulatedBalance);
                          contributionsData.push(simulatedTotalContributed + currentSavings); // Cumulative Contributions + Initial
                          growthData.push(simulatedBalance - (simulatedTotalContributed + currentSavings));
                     }
                }

                const projectedFinalSavings = simulatedBalance;
                const totalContributedWithInitial = simulatedTotalContributed + currentSavings;
                const totalGrowthEarned = projectedFinalSavings - totalContributedWithInitial;
                const finalTotalGrowthEarned = Math.max(0, totalGrowthEarned); // Ensure growth isn't negative


                // Update result elements
                if(amountToSaveEl) amountToSaveEl.textContent = formatCurrency(amountNeededFromNow);
                if(requiredContributionEl) {
                     if (timeframeType === 'years') {
                         requiredContributionEl.textContent = formatCurrency(requiredMonthlyContribution * 12); // Show annual contribution
                     } else {
                         requiredContributionEl.textContent = formatCurrency(requiredMonthlyContribution); // Show monthly contribution
                     }
                }
                if(projectedFinalSavingsEl) projectedFinalSavingsEl.textContent = formatCurrency(projectedFinalSavings);
                if(totalContributedEl) totalContributedEl.textContent = formatCurrency(totalContributedWithInitial); // Include initial savings in total contributed shown
                if(totalGrowthEarnedEl) totalGrowthEarnedEl.textContent = formatCurrency(finalTotalGrowthEarned);


                // Show results section
                if(savingsResultsSection) savingsResultsSection.style.display = 'block';

                // Update chart - Pass all necessary data including growth
                updateSavingsGoalChart(periodLabels, balanceData, contributionsData, growthData);

                 // Optional: Scroll to results
                 if(savingsResultsSection) {
                     savingsResultsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                 }

                 savingsCalculateBtn.innerHTML = '<i class="fas fa-chart-line"></i> Plan Savings';
                 savingsCalculateBtn.disabled = false;

             }, 50); // Short delay for button animation

        }

        function clearSavingsGoalResults() {
            // Clear result elements
            if(amountToSaveEl) amountToSaveEl.textContent = 'R0.00';
            if(requiredContributionEl) requiredContributionEl.textContent = 'R0.00';
            if(projectedFinalSavingsEl) projectedFinalSavingsEl.textContent = 'R0.00';
            if(totalContributedEl) totalContributedEl.textContent = 'R0.00';
            if(totalGrowthEarnedEl) totalGrowthEarnedEl.textContent = 'R0.00';

            // Hide results section
            if(savingsResultsSection) savingsResultsSection.style.display = 'none';

            // Destroy chart
            if (savingsGrowthChart) {
               savingsGrowthChart.destroy();
               savingsGrowthChart = null; // Clear the reference
            }
             // Clear canvas explicitly if chart was destroyed
            if (savingsGrowthCanvas) {
                 const ctx = savingsGrowthCanvas.getContext('2d');
                 ctx.clearRect(0, 0, savingsGrowthCanvas.width, savingsGrowthCanvas.height);
                 // Optional: Draw placeholder text if needed
                 // ctx.fillStyle = var(--text-light);
                 // ctx.textAlign = 'center';
                 // ctx.fillText("Enter details to see your savings growth chart", savingsGrowthCanvas.width / 2, savingsGrowthCanvas.height / 2);
             }
        }


         // Function to update the Savings Growth Line Chart (Enhanced)
         function updateSavingsGoalChart(periods, balances, cumulativeContributions, growthData) {
             if (!savingsGrowthCanvas) return;
            const ctx = savingsGrowthCanvas.getContext('2d');

            // Destroy the previous chart instance if it exists
            if (savingsGrowthChart) {
                savingsGrowthChart.destroy();
            }

             // Determine the label for the X-axis
             const timeframeType = timeframeTypeSelect ? timeframeTypeSelect.value : 'years';
             const xAxisLabel = timeframeType === 'years' ? 'Years' : 'Months';

            // Create the new Chart.js instance
             savingsGrowthChart = new Chart(ctx, {
                 type: 'line', // Use 'line' for the chart type
                 data: {
                     labels: periods, // Periods on the X-axis
                     datasets: [
                         {
                            label: 'Projected Savings Balance',
                            data: balances, // Balance over time
                            borderColor: chartBalanceColor, // Blue line
                            backgroundColor: chartBalanceFillColor, // Light blue fill below the line
                            fill: 'origin', // Fill area below the line starting from the X-axis
                            tension: 0.2, // Smooth the line slightly more
                            pointRadius: 3, // Reduce point size
                            pointHoverRadius: 5,
                            pointBackgroundColor: chartBalanceColor // Make points match line color
                          },
                         {
                             label: 'Cumulative Contributions',
                             data: cumulativeContributions, // Contributions over time
                             borderColor: chartContributionsColor, // Teal/Green line
                             backgroundColor: 'transparent', // No fill below this line
                             fill: false,
                             tension: 0.2,
                             pointRadius: 3,
                             pointHoverRadius: 5,
                              pointBackgroundColor: chartContributionsColor // Make points match line color
                         }
                         // Optionally add a dataset for just the growth amount if desired
                         /*
                         {
                             label: 'Estimated Growth Earned',
                             data: growthData, // Growth earned over time
                             borderColor: chartGrowthColor, // Yellow line
                             backgroundColor: 'transparent', // No fill
                             fill: false,
                             tension: 0.2,
                             pointRadius: 3,
                             pointHoverRadius: 5,
                             pointBackgroundColor: chartGrowthColor
                         }
                         */
                     ]
                 },
                 options: {
                     responsive: true,
                     maintainAspectRatio: false, // Allow chart to fit container size
                     plugins: {
                          legend: {
                              position: 'bottom', // Position legend below the chart
                              labels: {
                                  boxWidth: 16, // Slightly larger legend color box
                                  padding: 20, // More space between legend items
                                   font: { size: 12 } // Slightly larger font
                              }
                          },
                          tooltip: {
                              callbacks: {
                                  // Custom tooltip to show currency and period
                                  label: function(context) {
                                      const label = context.dataset.label || '';
                                      const value = context.raw; // The data point value
                                      const period = context.label; // The X-axis label (Period)
                                      return `${label}: ${formatCurrency(value)} (${period})`; // Format: Label: RValue (Period)
                                  }
                                  /* // Optional: Add a title to the tooltip showing the period
                                  title: function(context) {
                                      return context[0].label; // The period
                                  }
                                  */
                              },
                              backgroundColor: 'rgba(0, 0, 0, 0.8)', // Darker tooltip background
                              titleColor: '#fff',
                              bodyColor: '#fff',
                              borderColor: 'var(--primary)',
                              borderWidth: 1,
                              cornerRadius: 4,
                              padding: 10
                          }
                     },
                     scales: {
                         x: {
                             title: {
                                 display: true,
                                 text: xAxisLabel, // Use dynamic label
                                 font: { size: 14, weight: 'bold' },
                                 color: var(--text-light)
                             },
                             grid: {
                                 display: false // Hide x-axis grid lines
                             }
                         },
                         y: {
                             title: {
                                 display: true,
                                 text: 'Amount (R)',
                                 font: { size: 14, weight: 'bold' },
                                  color: var(--text-light)
                             },
                              ticks: {
                                   callback: function(value, index, values) {
                                       // Format Y-axis labels as currency (e.g., R100K, R50K, R1M)
                                       if (value >= 1000000) {
                                           return 'R' + (value / 1000000).toFixed(value % 1000000 !== 0 ? 1 : 0) + 'M'; // Show 1 decimal if not whole million
                                       } else if (value >= 1000) {
                                           return 'R' + (value / 1000).toFixed(0) + 'K';
                                       }
                                       return formatCurrency(value); // Fallback for smaller values
                                   }
                              },
                              grid: {
                                   color: var(--border) // Use border color for y-axis grid lines
                              }
                         }
                     },
                     layout: {
                         padding: 10 // Add some padding around the chart
                     }
                 }
             });
              savingsGrowthCanvas.chart = savingsGrowthChart; // Store chart instance
         }


        // Event Listeners
        if (savingsCalculateBtn) savingsCalculateBtn.addEventListener('click', calculateSavingsGoal);
        if (savingsResetBtn) {
            savingsResetBtn.addEventListener('click', function() {
                // Use a timeout to allow form.reset() to complete before clearing results
                setTimeout(function() {
                    clearSavingsGoalResults();
                     // Clear validation messages and invalid classes
                     document.querySelectorAll('.form-message').forEach(msg => {
                         msg.textContent = '';
                         msg.classList.remove('active');
                     });
                      document.querySelectorAll('.form-control').forEach(input => {
                          input.classList.remove('invalid');
                      });
                     // Reset timeframe unit display and label
                     if(timeframeTypeSelect && timeframeUnitSpan && requiredContributionLabelEl) {
                         timeframeTypeSelect.value = 'years'; // Ensure select is reset
                         timeframeUnitSpan.textContent = 'Years';
                         requiredContributionLabelEl.textContent = 'Required Annual Contribution:';
                          if (timeframeInput) timeframeInput.value = 5; // Reset default value
                     }

                }, 50); // Short delay
            });
        }

         // Optional: Recalculate on Enter key in any input field within the form
         if (savingsGoalForm) {
             savingsGoalForm.addEventListener('keypress', function(event) {
                 if (event.key === 'Enter') {
                     event.preventDefault(); // Prevent form submission
                     calculateSavingsGoal();
                 }
             });
         }


        // --- Initial Load Logic ---
        window.addEventListener('load', function() {
             // On initial load, clear results and hide the results section
            clearSavingsGoalResults();

             // Clear any existing validation messages
             document.querySelectorAll('.form-message').forEach(msg => {
                 msg.textContent = '';
                 msg.classList.remove('active');
             });
              document.querySelectorAll('.form-control').forEach(input => {
                  input.classList.remove('invalid');
              });

             // Set initial timeframe unit display and label
             if(timeframeTypeSelect && timeframeUnitSpan && requiredContributionLabelEl) {
                 timeframeUnitSpan.textContent = timeframeTypeSelect.value === 'years' ? 'Years' : 'Months';
                 requiredContributionLabelEl.textContent = timeframeTypeSelect.value === 'years' ? 'Required Annual Contribution:' : 'Required Monthly Contribution:';
             }


            // --- Active Nav Link Highlighting (Update for savings-goal-planner.html) ---
            const navLinks = document.querySelectorAll('.nav-menu .nav-link');
            const currentPath = window.location.pathname;

            navLinks.forEach(link => {
                const linkHref = link.getAttribute('href');
                // Check if the current path ends with the link's href (handles index.html, sars-tax-calculator.html, etc.)
                // Also handle the case where the href is just '/' for the home page
                 // Check for direct match, ignoring trailing slash for root
                 const isDirectMatch = (currentPath === '/' && linkHref === '/') ||
                                       (currentPath.endsWith('.html') && currentPath.endsWith(linkHref));

                if (isDirectMatch) {
                     navLinks.forEach(l => l.classList.remove('active')); // Remove active from all
                     link.classList.add('active'); // Add active to the matching link
                }
                 // Highlight the 'Financial Tools' link when on any calculator page
                else if (currentPath.includes('-calculator.html') && linkHref === '/#tools') {
                      navLinks.forEach(l => l.classList.remove('active')); // Remove active from others first
                      link.classList.add('active');
                }
                 // Handle hash links on the homepage - only activate if on the homepage
                else if (currentPath === '/' && linkHref.startsWith('#')) {
                     // No specific action needed for highlighting based on hash on load
                     // The '/#tools' case above handles the link to this page
                }
                 // For savings-goal-planner.html specifically, ensure the Financial Tools link is active if not already
                 // This handles the case where someone navigates directly to the savings planner URL
                 if (currentPath.endsWith('/savings-goal-planner.html') && linkHref === '/#tools' && !document.querySelector('.nav-menu .nav-link.active')) {
                     link.classList.add('active');
                 } else if (currentPath.endsWith('/savings-goal-planner.html') && linkHref === '/savings-goal-planner.html') {
                      // Ensure the savings planner link itself is active if directly on the page
                      navLinks.forEach(l => l.classList.remove('active'));
                      link.classList.add('active');
                 }
            });
             // Ensure home is active as a fallback if nothing else matched and on the root path
             const homeLink = document.querySelector('.nav-menu a[href="/"]');
             if ((currentPath === '/' || currentPath.endsWith('/index.html')) && !document.querySelector('.nav-menu .nav-link.active')) {
                  if (homeLink) homeLink.classList.add('active');
             }
        });


    </script>
</body>
</html>
